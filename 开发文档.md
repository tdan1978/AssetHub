IT 资产管理系统 (ITAM) 综合设计与开发规格说明书

1. 项目概述与架构

1.1 项目背景

针对企业 IT 资产（硬件、软件授权）管理混乱、信息滞后等问题，构建全生命周期管理系统。

1.2 技术栈选型

后端: Python 3.9+ (FastAPI), SQLAlchemy 2.0 (ORM), Pydantic v2 (校验), Alembic (迁移)。

前端: Vue 3 (Composition API), Vite, Element Plus, Pinia, Axios。

数据库: MySQL 8.0 (InnoDB), Redis (缓存/限流)。

工具: Pandas (Excel), QRCode (二维码), Jose (JWT)。

2. 核心角色与权限矩阵 (RBAC)

系统采用基于角色的访问控制，权限定义如下：

角色

权限范围

核心业务操作

超级管理员

全模块权限

系统配置、角色分配、操作审计日志查看、数据备份。

资产管理员

资产全生命周期管理

入库、领用/退库审批、维保更新、发起盘点任务。

财务/审计员

资产财务视图

价值查询、折旧统计、合同附件查看、导出审计报表。

普通员工

个人资产工作台

查看名下资产、在线报修、领用申请、扫码核对。

3. 数据库物理模型设计 (MySQL)

3.1 核心表结构

A. 资产基础表 (assets)

字段名

类型

约束

说明

id

INT

PK, AI

自增主键

sn

VARCHAR(64)

UNIQUE, INDEX

序列号 (核心唯一索引)

asset_no

VARCHAR(64)

UNIQUE

内部编号 (自定义规则生成)

name

VARCHAR(128)

NOT NULL

资产名称

category_id

INT

FK

关联分类表

status

TINYINT

INDEX

0:闲置, 1:在用, 2:维修, 3:待报废, 4:已报废

user_id

INT

FK, NULL

当前持有员工 ID

dept_id

INT

FK

所属部门 ID

price

DECIMAL(12,2)



采购原值

purchase_at

DATE



采购日期

warranty_at

DATE



维保截止日期

is_deleted

TINYINT(1)

DEFAULT 0

软删除标记

B. 变更日志表 (asset_logs)

字段名

类型

说明

id

BIGINT

PK

asset_id

INT

关联资产

operator_id

INT

操作人 ID

action_type

VARCHAR(20)

CHECK (LOGIN, IN, OUT, TRANSFER, REPAIR, DISCARD)

change_data

JSON

记录字段变更内容: {"field": "status", "old": 0, "new": 1}

created_at

DATETIME

操作时间

C. 软件授权表 (licenses)

字段名

类型

说明

id

INT

PK

name

VARCHAR(100)

软件名称

license_key

TEXT

授权密钥

total_qty

INT

总授权数

used_qty

INT

已分配数

expire_at

DATE

到期日期

4. 业务逻辑与 API 规范

4.1 资产入库逻辑 (Import/Create)

单一录入: 必须校验 sn 在 is_deleted=0 的数据中唯一。

批量导入 (Excel):

静态校验: 检查必填项、日期格式、数值范围。

业务校验: 检查 SN 是否重复、Category 名称是否匹配数据库。

反馈: 失败时返回包含“错误原因列”的 Excel。

API: POST /api/v1/assets/batch-import

4.2 资产流转控制 (Check-in/Out)

领用事务:

验证资产 status == 0 (闲置)。

更新 assets 表: status=1, user_id=target_id。

异步写入 asset_logs。

数据库操作需使用 SELECT ... FOR UPDATE 行级锁防止超领。

API: POST /api/v1/assets/{id}/checkout

4.3 智能盘点逻辑

盘点任务: 管理员创建任务后，系统生成待盘点清单快照。

移动端扫码: * 匹配: scanned_at 更新。

异常: 标记为“位置变动”或“信息不符”。

API: GET /api/v1/stocktake/{task_id}/progress

5. 前端架构设计 (Vue 3)

5.1 全局状态管理 (Pinia)

useAuthStore: 管理 JWT、用户信息、路由权限菜单。

useAssetStore: 缓存常用的分类列表、部门树，减少 API 重复请求。

5.2 核心组件清单

AssetTable.vue: 集成后端分页、多条件筛选、自定义列显示。

QRScanner.vue: 基于 html5-qrcode 的移动端扫码组件。

ImportDialog.vue: 带有上传进度条和错误列表展示的导入组件。

6. 安全性与性能约束

6.1 安全审计 (Security)

加密: 密码 Bcrypt 加密存储。

认证: JWT 存放于 HttpOnly Cookie 或 Header。

敏感操作: 导出 Excel、修改权限等操作必须强制记录 operator_id 和 client_ip。

6.2 性能指标 (Performance)

查询优化: assets 表针对 sn, status, dept_id 建立复合索引。

响应时间: 列表翻页查询延迟 < 300ms。

并发: 支持 50+ 同时扫码盘点，使用 Redis 缓存热点资产信息。

7. 部署规范

容器化: 提供 docker-compose.yml 包含 app, mysql, redis, nginx。

静态资源: Nginx 托管 Vue 构建后的 dist 目录，并配置 /api 转发。

备份策略: 每日凌晨 3 点利用 mysqldump 备份至 /backup 目录并保留 30 天。